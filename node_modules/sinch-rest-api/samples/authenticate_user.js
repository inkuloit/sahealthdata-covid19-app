// Authenticate user in your userspace (requires JS Auth to be enabled for application)
// Exercise: Generate your own ticket and use to retrieve the calling configuration w. JS Auth disabled
// (hint: see sinch-ticketgen module for generating tickets)

// Sample is compatible with browserify. Compile using:
//    browserify --ignore syncoprompt authenticate_user.js | uglifyjs > bundle.js

var sinchRestApi = require('../index.js')({
  key: 'APPLICATION_KEY',
});

var prompt = require('syncoprompt').prompt || window.prompt;

var username = prompt('Enter username to authenticate: ');
var password = prompt('Enter password of user: ');

var consoleOut = function(result) { console.log(result); }

sinchRestApi.user.authenticateUsername({username: username, password: password}) // Auth user & get auth ticket
	.then(sinchRestApi.base.getInstance) // Exchange ticket for instance
	.then(sinchRestApi.pushInstance.bind(sinchRestApi)) // Push instance to use as credentials in future requests
	.then(sinchRestApi.calling.getConfiguration) // Make a request as authenticated user
	.then(consoleOut)
	.fail(consoleOut)